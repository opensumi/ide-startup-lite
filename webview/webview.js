!function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"WebIframeChannel",(function(){return o}));class o{constructor(){this.handlers=new Map,this.fakeLoad=!1,this.isInDevelopmentMode=!1,this.id=document.location.search.match(/\bid=([\w-]+)/)[1],window.addEventListener("message",e=>{if(e.data&&("onmessage"===e.data.command||"do-update-state"===e.data.command))return void this.postMessage(e.data.command,e.data.data);const t=e.data.channel,n=this.handlers.get(t);n?n(e,e.data.data):console.log("no handler for ",e)}),this.ready=new Promise(async e=>{e()}),this.onMessage("devtools-opened",()=>{this.isInDevelopmentMode=!0})}get inDev(){return this.isInDevelopmentMode}postMessage(e,t){window.parent!==window&&window.parent.postMessage({target:this.id,channel:e,data:t},"*")}onMessage(e,t){this.handlers.set(e,t)}onIframeLoaded(e){}onKeydown(e){"s"===e.key&&(e.metaKey||e.ctrlKey)&&e.preventDefault()}}new class{constructor(e){this.channel=e,this.activeTheme="default",this.isHandlingScroll=!1,this.updateId=0,this.firstLoad=!0,this.pendingMessages=[],document.addEventListener("DOMContentLoaded",this.init.bind(this))}init(){const e=document.location.search.match(/\bid=([\w-]+)/);this.ID=e?e[1]:void 0,document.body&&(this.channel.onMessage("styles",(e,t)=>{this.styles=t.styles,this.activeTheme=t.activeTheme;const n=this.getActiveFrame();n&&n.contentDocument&&this.applyStyles(n.contentDocument,n.contentDocument.body)}),this.channel.onMessage("focus",()=>{const e=this.getActiveFrame();e&&e.contentWindow&&e.contentWindow.focus()}),this.channel.onMessage("content",async(e,t)=>this.setContent(t)),this.channel.onMessage("message",(e,t)=>{if(!this.getPendingFrame()){const e=this.getActiveFrame();if(e)return void e.contentWindow.postMessage(t,"*")}this.pendingMessages.push(t)}),this.trackFocus({onFocus:()=>this.channel.postMessage("did-focus"),onBlur:()=>this.channel.postMessage("did-blur")}),this.channel.postMessage("webview-ready",{}))}async setContent(e){const t=++this.updateId;if(await this.channel.ready,t!==this.updateId)return;const n=e.options,o=this.toContentHtml(e),s=this.getActiveFrame(),i=this.firstLoad;let a;if(this.firstLoad)this.firstLoad=!1,a=(e,t)=>{isNaN(this.initialScrollProgress)||0===t.scrollY&&t.scroll(0,e.clientHeight*this.initialScrollProgress)};else{const e=s&&s.contentDocument&&s.contentDocument.body?s.contentWindow.scrollY:0;a=(t,n)=>{0===n.scrollY&&n.scroll(0,e)}}const r=this.getPendingFrame();r&&(r.setAttribute("id",""),document.body.removeChild(r)),i||(this.pendingMessages=[]);const c=document.createElement("iframe");c.setAttribute("id","pending-frame"),c.setAttribute("frameborder","0"),c.setAttribute("allow","autoplay");const d=new Set(["allow-same-origin","allow-pointer-lock"]);n.allowScripts&&(d.add("allow-scripts"),d.add("allow-downloads")),n.allowForms&&d.add("allow-forms"),c.setAttribute("sandbox",Array.from(d).join(" ")),this.channel.fakeLoad&&(c.src="./fake.html?id="+this.ID),c.style.cssText="display: block; margin: 0; overflow: hidden; position: absolute; width: 100%; height: 100%; visibility: hidden",document.body.appendChild(c),this.channel.fakeLoad||c.contentDocument.open(),c.contentWindow.addEventListener("keydown",this.handleInnerKeydown.bind(this)),c.contentWindow.addEventListener("DOMContentLoaded",e=>{this.channel.fakeLoad&&(c.contentDocument.open(),c.contentDocument.write(o),c.contentDocument.close(),h(c));const t=e.target?e.target:void 0;t&&this.applyStyles(t,t.body)});const l=(e,t)=>{e&&e.body&&a(e.body,t);const n=this.getPendingFrame();if(n&&n.contentDocument&&n.contentDocument===e){const e=this.getActiveFrame();e&&document.body.removeChild(e),this.applyStyles(n.contentDocument,n.contentDocument.body),n.setAttribute("id","active-frame"),n.style.visibility="visible",this.channel.focusIframeOnCreate&&n.contentWindow.focus(),t.addEventListener("scroll",this.handleInnerScroll.bind(this)),this.pendingMessages.forEach(e=>{t.postMessage(e,"*")}),this.pendingMessages=[]}},h=e=>{clearTimeout(this.loadTimeout),this.loadTimeout=void 0,this.loadTimeout=setTimeout(()=>{clearTimeout(this.loadTimeout),this.loadTimeout=void 0,l(e.contentDocument,e.contentWindow)},1e3);const t=this;e.contentWindow.addEventListener("load",(function(e){t.loadTimeout&&(clearTimeout(t.loadTimeout),t.loadTimeout=void 0,l(e.target,this))})),e.contentWindow.addEventListener("click",this.handleInnerClick.bind(this)),this.channel.onIframeLoaded&&this.channel.onIframeLoaded(e)};this.channel.fakeLoad||h(c),this.channel.fakeLoad||(c.contentDocument.write(o),c.contentDocument.close()),this.channel.postMessage("did-set-content",void 0)}trackFocus({onFocus:e,onBlur:t}){let n=document.hasFocus();setInterval(()=>{const o=document.hasFocus();o!==n&&(n=o,o?e():t())},50)}getActiveFrame(){return document.getElementById("active-frame")}getPendingFrame(){return document.getElementById("pending-frame")}get defaultCssRules(){return"body {\n  background-color: var(--vscode-editor-background);\n  color: var(--vscode-editor-foreground);\n  font-family: var(--vscode-font-family);\n  font-weight: var(--vscode-font-weight);\n  font-size: var(--vscode-font-size);\n  margin: 0;\n  padding: 0 20px;\n}\n\nimg {\n  max-width: 100%;\n  max-height: 100%;\n}\n\na {\n  color: var(--vscode-textLink-foreground);\n}\n\na:hover {\n  color: var(--vscode-textLink-activeForeground);\n}\n\na:focus,\ninput:focus,\nselect:focus,\ntextarea:focus {\n  outline: 1px solid -webkit-focus-ring-color;\n  outline-offset: -1px;\n}\n\ncode {\n  color: var(--vscode-textPreformat-foreground);\n}\n\nblockquote {\n  background: var(--vscode-textBlockQuote-background);\n  border-color: var(--vscode-textBlockQuote-border);\n}\n\n::-webkit-scrollbar {\n  width: 10px;\n  height: 10px;\n}\n\n::-webkit-scrollbar-thumb {\n  background-color: var(--vscode-scrollbarSlider-background);\n}\n::-webkit-scrollbar-thumb:hover {\n  background-color: var(--vscode-scrollbarSlider-hoverBackground);\n}\n::-webkit-scrollbar-thumb:active {\n  background-color: var(--vscode-scrollbarSlider-activeBackground);\n}\n::-webkit-scrollbar-corner {\n  background: transparent;\n}"}applyStyles(e,t){if(e&&(t&&(t.classList.remove("vscode-light","vscode-dark","vscode-high-contrast"),t.classList.add(this.activeTheme)),this.styles))for(const t of Object.keys(this.styles))e.documentElement.style.setProperty("--"+t,this.styles[t])}handleInnerClick(e){if(!e||!e.view||!e.view.document)return;const t=e.view.document.getElementsByTagName("base")[0];let n=e.target;for(;n;){if(n.tagName&&"a"===n.tagName.toLowerCase()&&n.href){if("#"===n.getAttribute("href"))e.view.scrollTo(0,0);else if(n.hash&&(n.getAttribute("href")===n.hash||t&&n.href.indexOf(t.href)>=0)){const t=e.view.document.getElementById(n.hash.substr(1,n.hash.length-1));t&&t.scrollIntoView()}else this.channel.postMessage("did-click-link",n.href.baseVal||n.href);e.preventDefault();break}n=n.parentNode}}handleInnerKeydown(e){this.channel.postMessage("did-keydown",{key:e.key,keyCode:e.keyCode,code:e.code,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,repeat:e.repeat}),this.channel.onKeydown&&this.channel.onKeydown(e)}handleInnerScroll(e){if(!e.target||!e.target.body)return;if(this.isHandlingScroll)return;const t=e.currentTarget.scrollY/e.target.body.clientHeight;isNaN(t)||(this.isHandlingScroll=!0,window.requestAnimationFrame(()=>{try{this.channel.postMessage("did-scroll",t)}catch(e){}this.isHandlingScroll=!1}))}toContentHtml(e){const t=e.options,n=e.contents,o=(new DOMParser).parseFromString(n,"text/html");if(o.querySelectorAll("a").forEach(e=>{e.title||(e.title=e.getAttribute("href"))}),t.allowScripts){const t=o.createElement("script");t.textContent=`\n    const acquireVsCodeApi = (function() {\n      const originalPostMessage = window.parent.postMessage.bind(window.parent);\n      const targetOrigin = '*';\n      let acquired = false;\n\n      let state = ${(s=e.state)?`JSON.parse("${i=JSON.stringify(s),(i+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")}")`:void 0};\n\n      return () => {\n        if (acquired) {\n          throw new Error('An instance of the VS Code API has already been acquired');\n        }\n        acquired = true;\n        return Object.freeze({\n          postMessage: function(msg) {\n            return originalPostMessage({ command: 'onmessage', data: msg }, targetOrigin);\n          },\n          setState: function(newState) {\n            state = newState;\n            originalPostMessage({ command: 'do-update-state', data: JSON.parse(JSON.stringify(newState)) }, targetOrigin);\n            return newState;\n          },\n          getState: function() {\n            return state;\n          }\n        });\n      };\n    })();\n    delete window.parent;\n    delete window.top;\n    delete window.frameElement;\n    window.acquireVsCodeApi = acquireVsCodeApi;\n  `,o.head.prepend(t)}var s,i;const a=o.createElement("style");return a.id="_defaultStyles",a.innerHTML=this.defaultCssRules,o.head.prepend(a),this.applyStyles(o,o.body),"<!DOCTYPE html>\n"+o.documentElement.outerHTML}}(new o)}]);